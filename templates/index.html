<!doctype html>
<html lang="en">
<head>
    <!-- Webpage Title -->
    <title>My-Hidden-Song</title>
    <link rel="shortcut icon" href="../static/favicon.png" type="image/x-icon">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <meta property="og:title" content="My-Hidden-Song"/>
    <meta property="og:description" content="나만의 숨겨진 노래를 올려주세요!"/>
    <meta property="og:image" content="../static/favicon.png"/>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <!-- Font Awesome CSS -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Gamja+Flower&family=Stylish&display=swap" rel="stylesheet">
    <link href="{{ url_for('static', filename='mystyle.css') }}" rel="stylesheet">

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>

    <!-- google font -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100&display=swap" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@700&display=swap" rel="stylesheet">

    <style>
        * {
            font-family: 'Noto Sans KR', sans-serif;
        }

        .title {
            text-align: center;
            font-family: 'Courier Prime', monospace;
            font-size: 80px;
            color: #fff;
            -webkit-text-stroke: 1px #000;
            cursor: pointer;
        }

        .box {
            background-color: #e0e0e0;
            margin-left: 50px;
        }

        .content {
            margin-top: 19%;
        }

        .input {
            font-weight: bold;
        }

        .is-sparta {
            background-color: #8e44ad;
            color: #fff;
            font-weight: 500;
        }

        .button:hover {
            color: #8e44ad;
            background-color: #fff;
            transition-duration: 0.3s;
        }
    </style>

    <script>
        // {% if msg %}
            //    alert("{{ msg }}")
            // {% endif %}
        $(document).ready(function () {
            getYoutubeUrl()
        });

        function getYoutubeUrl() {
            $.ajax({
                type: "GET",
                url: "/getYoutubeUrl",
                data: {},
                success: function (response) {
                    if (response['result'] == 'success') {
                        $("#youtubeFrame").attr("src", "https://www.youtube.com/embed/" + response['youtubeUrl'] + "?autoplay=1&mute=1")
                    } else {
                        alert(response['msg']);
                    }
                }
            });
        }

        function sign_in() {
            let id = $("#input-id").val()
            let pw = $("#input-pw").val()

            if (id == "") {
                $("#help-id-login").text("아이디를 입력해주세요.")
                $("#input-id").focus()
                return;
            } else {
                $("#help-id-login").text("")
            }

            if (pw == "") {
                $("#help-pw-login").text("비밀번호를 입력해주세요.")
                $("#input-pw").focus()
                return;
            } else {
                $("#help-pw-login").text("")
            }
            $.ajax({
                type: "POST",
                url: "/sign_in",
                data: {
                    id_give: id,
                    pw_give: pw
                },
                success: function (response) {
                    if (response['result'] == 'success') {
                        $.cookie('mytoken', response['token'], {path: '/'});
                        window.location.replace("/")
                    } else {
                        alert(response['msg'])
                    }
                }
            });
        }


    </script>


</head>
<body>

<section class="hero">
    <div class="hero-body">
        <p class="title" onclick="window.location.href='/'">
            My-Hidden-Song
        </p>
    </div>
</section>


<section class="section">
    <div class="container">
        <div class="columns">

            <div class="box column is-one-third" style="">
                <article class="media">
                    <div class="media-content">
                        <div class="content">
                            <div class="field has-addons">
                                <div class="control has-icons-left" style="width:100%">
                                    <input id="input-id" class="input" type="text" placeholder="아이디">
                                    <span class="icon is-small is-left"><i class="fa fa-user"></i></span>
                                </div>
                            </div>
                            <p id="help-id-login" class="help is-danger"></p>
                            <div class="field">
                                <div class="control has-icons-left">
                                    <input id="input-pw" class="input" type="password" placeholder="비밀번호">
                                    <span class="icon is-small is-left"><i class="fa fa-lock"></i></span>
                                </div>
                                <p id="help-pw-login" class="help is-danger"></p>
                            </div>
                        </div>
                        <div id="div-sign-in-or-up" class="has-text-centered">
                            <nav class="level is-mobile">
                                <button class="level-item button is-sparta" onclick="sign_in()">
                                    로그인
                                </button>
                            </nav>
                            <hr>
                            <h4 class="mb-3"><b>아직 회원이 아니라면</b></h4>
                            <nav class="level is-mobile">
                                <button class="level-item button is-sparta is-outlined"
                                        onclick="window.location.href='/sign_up'">
                                    회원가입하기
                                </button>
                            </nav>
                        </div>
                    </div>
                </article>
            </div>
            <div class="box column is-tow-third " style="margin-bottom:1.5em;">
                <figure class="image is-16by9">
                    <iframe class="has-ratio" id="youtubeFrame" width="640" height="360" src="" frameborder="0"
                            allowfullscreen allow="autoplay;mute;"></iframe>
                </figure>
            </div>
        </div>
    </div>
</section>
</body>
</html>